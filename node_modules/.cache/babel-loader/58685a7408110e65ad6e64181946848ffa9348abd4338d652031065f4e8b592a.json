{"ast":null,"code":"var _jsxFileName = \"/Users/leosponnich/Documents/firebase_test/src/pages/display/display.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useState } from 'react';\nimport { db } from '../../firebase/firebase';\nimport { collection, query, where, getDocs, updateDoc, doc, setDoc, getDoc, addDoc } from 'firebase/firestore';\nimport FloatingComponent from '../floating/floating';\nimport Dialog from '@mui/material/Dialog';\nimport './display.css';\nimport { exchangeCodeForToken, refreshToken } from '../../spotify/auth/auth'; // Import token handling functions\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Display(props) {\n  _s();\n  //Dialog\n  const [selectedData, setSelectedData] = useState(null);\n  const [open, setOpen] = useState(false);\n\n  //tokens\n  const [accessToken, setAccessToken] = useState(null);\n  const [expiresIn, setExpiresIn] = useState(null);\n  const [refreshToken, setRefreshToken] = useState(null);\n  const {\n    authCode\n  } = props;\n\n  //Userdata cleanup\n  const [user, setUser] = useState(null);\n  const [song, setSong] = useState(null);\n\n  //userdata\n\n  const [userList, setUserList] = useState([]);\n\n  //updating song when user changes\n  const [countdown, setCountdown] = useState(15);\n  const [first, setFirst] = useState(false);\n\n  //clock for refreshing userSong\n  useEffect(() => {\n    const interval = setInterval(() => {\n      if (countdown > 0) {\n        setCountdown(countdown - 1);\n      } else {\n        clearInterval(interval);\n      }\n    }, 1000);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [countdown]);\n\n  // Token exchange\n  useEffect(() => {\n    if (authCode) {\n      exchangeCodeForToken(authCode).then(data => {\n        setAccessToken(data.accessToken);\n        setExpiresIn(data.expiresIn);\n        setRefreshToken(data.refreshToken);\n      }).catch(error => {\n        console.error('Error exchanging code for access token:', error);\n      });\n    }\n  }, [authCode]);\n\n  // Refreshing accessToken when access expires\n  useEffect(() => {\n    if (!expiresIn || !refreshToken) return;\n    const interval = setInterval(() => {\n      refreshToken(refreshToken).then(data => {\n        setAccessToken(data.accessToken);\n        setExpiresIn(data.expiresIn);\n        setRefreshToken(data.refreshToken);\n      }).catch(error => {\n        console.error('Error refreshing token:', error);\n      });\n    }, (expiresIn - 60) * 1000);\n    return () => clearInterval(interval);\n  }, [expiresIn, refreshToken]);\n\n  //fetching user image and name\n  const fetchUserInfo = async token => {\n    try {\n      const response = await fetch('https://api.spotify.com/v1/me', {\n        headers: {\n          'Authorization': 'Bearer ' + token\n        }\n      });\n      const userData = response.json();\n      return userData;\n    } catch (error) {\n      console.error('Error:', error);\n    }\n  };\n  useEffect(() => {\n    if (!accessToken) return;\n    const runFetchUserInfo = () => {\n      fetchUserInfo(accessToken).then(res => {\n        setUser(res);\n      });\n    };\n    runFetchUserInfo();\n  }, [accessToken]);\n\n  //fetching songName and preview url\n  const fetchNowPlaying = async token => {\n    try {\n      var _data$item, _data$item2;\n      const response = await fetch(\"https://api.spotify.com/v1/me/player/currently-playing\", {\n        headers: {\n          'Authorization': 'Bearer ' + token\n        }\n      });\n      const data = await response.json();\n      const preview = (data === null || data === void 0 ? void 0 : (_data$item = data.item) === null || _data$item === void 0 ? void 0 : _data$item.preview_url) || 'no preview';\n      const songName = (data === null || data === void 0 ? void 0 : (_data$item2 = data.item) === null || _data$item2 === void 0 ? void 0 : _data$item2.name) || 'No song currently playing';\n      const songInfo = {\n        songName: songName,\n        songPreview: preview\n      };\n      return data;\n    } catch (error) {\n      console.error('Error:', error);\n    }\n  };\n  useEffect(() => {\n    if (!accessToken) return;\n    if (!user) return;\n    const func = () => {\n      fetchNowPlaying(accessToken).then(res => {\n        setSong(res);\n        const newObj = {\n          userSong: res.name,\n          userImg: user.images[1].url,\n          userName: user.display_name,\n          songPreview: res.preview_url\n        };\n        sendFloatingDataToFirebase(newObj);\n      });\n    };\n    if (!first || countdown === 0) {\n      fetchUsers();\n      func();\n      setFirst(true);\n      setCountdown(15);\n    }\n  }, [accessToken, countdown, user]);\n\n  //Dialog handlers\n  const handleComponentClick = data => {\n    setSelectedData(data);\n    setOpen(true);\n  };\n  const handleCloseDialog = () => {\n    setOpen(false);\n    setSelectedData(null);\n  };\n\n  //update firebase\n  const sendFloatingDataToFirebase = async data => {\n    try {\n      const docRef = await addDoc(collection(db, \"users\"), data);\n    } catch (error) {\n      console.error('Error updating data in Firebase:', error);\n    }\n  };\n\n  //get data from firebase\n  const fetchUsers = async () => {\n    try {\n      const userRef = collection(db, 'users');\n      const userQuerySnapshot = await getDocs(userRef);\n      const userDataArray = [];\n      userQuerySnapshot.forEach(doc => {\n        userDataArray.push(doc.data());\n      });\n      setUserList(userDataArray);\n      console.log(userList);\n    } catch (error) {\n      console.error('Error fetching data:', error);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"background\",\n    children: [/*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 211,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 214,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 221,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 222,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 224,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 225,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 228,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"span\", {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n        children: \"User Data:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 7\n      }, this), userList.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        children: userList.map((user, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"floating-body\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            alt: \"profile\",\n            src: user.profile_picture\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"floating-body-text\",\n            children: [/*#__PURE__*/_jsxDEV(\"p\", {\n              children: user.username\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 239,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n              children: [\"Now playing: \", user.song]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"audio\", {\n              controls: true,\n              autoPlay: true,\n              name: \"media\",\n              children: /*#__PURE__*/_jsxDEV(\"source\", {\n                src: user.preview_url,\n                type: \"audio/mpeg\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 242,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 15\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 13\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 9\n      }, this) : /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Loading...\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 5\n    }, this), userList.map((user, index) => /*#__PURE__*/_jsxDEV(FloatingComponent, {\n      // Make sure to use a unique key for each component\n      data: {\n        userSong: user.userSong,\n        userImg: user.userImg,\n        userName: user.userName,\n        songPreview: user.songPreview\n      },\n      onClick: handleComponentClick\n    }, index, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 9\n    }, this)), /*#__PURE__*/_jsxDEV(Dialog, {\n      open: open,\n      onClose: handleCloseDialog,\n      PaperProps: {\n        sx: {\n          width: '100vw',\n          height: '60svh',\n          borderRadius: '25%'\n        }\n      },\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"floating-body\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          alt: \"profile\",\n          src: selectedData ? selectedData.userImg : ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 276,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: handleCloseDialog,\n          children: \"exit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"floating-body-text\",\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: selectedData ? selectedData.userName : ''\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Now playing: \", selectedData ? selectedData.userSong : '']\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"video\", {\n            controls: true,\n            autoPlay: true,\n            name: \"media\",\n            children: /*#__PURE__*/_jsxDEV(\"source\", {\n              src: selectedData ? selectedData.songPreview : '',\n              type: \"audio/mpeg\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 282,\n              columnNumber: 11\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 278,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 275,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 5\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 210,\n    columnNumber: 3\n  }, this);\n}\n_s(Display, \"Dnz6zEu2janeWGf4jVv5oV+NqW4=\");\n_c = Display;\nexport default Display;\nvar _c;\n$RefreshReg$(_c, \"Display\");","map":{"version":3,"names":["React","useEffect","useState","db","collection","query","where","getDocs","updateDoc","doc","setDoc","getDoc","addDoc","FloatingComponent","Dialog","exchangeCodeForToken","refreshToken","jsxDEV","_jsxDEV","Display","props","_s","selectedData","setSelectedData","open","setOpen","accessToken","setAccessToken","expiresIn","setExpiresIn","setRefreshToken","authCode","user","setUser","song","setSong","userList","setUserList","countdown","setCountdown","first","setFirst","interval","setInterval","clearInterval","then","data","catch","error","console","fetchUserInfo","token","response","fetch","headers","userData","json","runFetchUserInfo","res","fetchNowPlaying","_data$item","_data$item2","preview","item","preview_url","songName","name","songInfo","songPreview","func","newObj","userSong","userImg","images","url","userName","display_name","sendFloatingDataToFirebase","fetchUsers","handleComponentClick","handleCloseDialog","docRef","userRef","userQuerySnapshot","userDataArray","forEach","push","log","className","children","fileName","_jsxFileName","lineNumber","columnNumber","length","map","index","alt","src","profile_picture","username","controls","autoPlay","type","onClick","onClose","PaperProps","sx","width","height","borderRadius","_c","$RefreshReg$"],"sources":["/Users/leosponnich/Documents/firebase_test/src/pages/display/display.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\nimport {db} from '../../firebase/firebase';\nimport {collection, query, where, getDocs, updateDoc, doc, setDoc, getDoc, addDoc} from 'firebase/firestore';\nimport FloatingComponent from '../floating/floating';\nimport Dialog from '@mui/material/Dialog';\nimport './display.css';\nimport { exchangeCodeForToken, refreshToken } from '../../spotify/auth/auth'; // Import token handling functions\n\nfunction Display(props) {\n    //Dialog\n    const [selectedData, setSelectedData] = useState(null);\n    const [open, setOpen] = useState(false);\n\n    //tokens\n    const [accessToken, setAccessToken] = useState(null);\n    const [expiresIn, setExpiresIn] = useState(null);\n    const [refreshToken, setRefreshToken] = useState(null);\n    const {authCode} = props;\n    \n\n    //Userdata cleanup\n    const[user,setUser] = useState(null);\n    const[song, setSong] = useState(null);\n\n\n\n    //userdata\n\n    const [userList, setUserList] = useState([]);\n   \n\n    //updating song when user changes\n    const [countdown, setCountdown] = useState(15);\n    const [first, setFirst] = useState(false);\n\n      //clock for refreshing userSong\n  useEffect(()=>{\n    const interval = setInterval(() => {\n      if(countdown>0){\n        setCountdown(countdown-1);\n      }\n      else{\n        clearInterval(interval);\n      }\n    },1000)\n    return () => {clearInterval(interval)}\n  },[countdown])\n\n    \n\n  // Token exchange\n  useEffect(() => {\n    if (authCode) {\n      exchangeCodeForToken(authCode)\n        .then((data) => {\n          setAccessToken(data.accessToken);\n          setExpiresIn(data.expiresIn);\n          setRefreshToken(data.refreshToken);\n        })\n        .catch((error) => {\n          console.error('Error exchanging code for access token:', error);\n        });\n    }\n  }, [authCode]);\n\n\n\n    // Refreshing accessToken when access expires\n    useEffect(() => {\n      if (!expiresIn || !refreshToken) return;\n      const interval = setInterval(() => {\n        refreshToken(refreshToken)\n          .then((data) => {\n            setAccessToken(data.accessToken);\n            setExpiresIn(data.expiresIn);\n            setRefreshToken(data.refreshToken);\n          })\n          .catch((error) => {\n            console.error('Error refreshing token:', error);\n          });\n      }, (expiresIn - 60) * 1000);\n    \n      return () => clearInterval(interval);\n    }, [expiresIn, refreshToken]);\n    \n\n\n\n\n\n\n  //fetching user image and name\n  const fetchUserInfo = async (token) => {\n    try {\n      const response = await fetch('https://api.spotify.com/v1/me', {\n        headers: {\n          'Authorization': 'Bearer ' + token,\n        },\n      });\n      const userData = response.json();\n      return userData;  \n\n    } catch (error) {\n      console.error('Error:', error);\n    }\n  };\n\n  useEffect(()=>{\n    if(!accessToken) return;\n    const runFetchUserInfo = () => {\n      fetchUserInfo(accessToken)\n      .then((res) => {\n        setUser(res);\n      })\n    }\n    runFetchUserInfo();\n    \n  },[accessToken]);\n\n\n  //fetching songName and preview url\n  const fetchNowPlaying = async (token) => {\n    try {\n      const response = await fetch(\"https://api.spotify.com/v1/me/player/currently-playing\", {\n        headers: {\n          'Authorization': 'Bearer ' + token,\n        },\n      });\n      const data = await response.json();\n      const preview = data?.item?.preview_url || 'no preview'; \n      const songName = data?.item?.name || 'No song currently playing';\n      const songInfo = {\n        songName:songName,\n        songPreview:preview\n      }\n      return data;\n    } catch (error) {\n      console.error('Error:', error);\n    }\n  }\n\n  useEffect(()=>{\n    if(!accessToken) return;\n    if(!user) return;\n    const func = () => {\n      fetchNowPlaying(accessToken)\n      .then((res)=>{\n        setSong(res);\n        const newObj = {\n          userSong: res.name,\n          userImg: user.images[1].url,\n          userName: user.display_name,\n          songPreview: res.preview_url\n        }\n        sendFloatingDataToFirebase(newObj);\n      })      \n    } \n    if(!first || countdown===0){\n      fetchUsers();\n      func();\n      setFirst(true);\n      setCountdown(15);\n    }\n  },[accessToken, countdown, user])\n\n\n  //Dialog handlers\n  const handleComponentClick = (data) => {\n    setSelectedData(data);\n    setOpen(true);\n  }\n\n  const handleCloseDialog = () => {\n    setOpen(false);\n    setSelectedData(null);\n  }\n\n  //update firebase\n  const sendFloatingDataToFirebase = async (data) => {\n    try {\n      const docRef = await addDoc(collection(db, \"users\"), data);\n\n    } catch (error) {\n      console.error('Error updating data in Firebase:', error);\n    }\n  };\n\n    \n\n    //get data from firebase\n    const fetchUsers = async () => {\n        try {\n          const userRef = collection(db, 'users');\n          const userQuerySnapshot = await getDocs(userRef);\n    \n          const userDataArray = [];\n          userQuerySnapshot.forEach((doc) => {\n            userDataArray.push(doc.data());\n          });\n    \n          setUserList(userDataArray);\n          console.log(userList);\n        } catch (error) {\n          console.error('Error fetching data:', error);\n        }\n      };\n  \n \n  return (\n  <div className=\"background\">\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <span></span>\n    <div>\n      <h1>User Data:</h1>\n      {userList.length > 0 ? (\n        <div>\n          {userList.map((user, index) => (\n            <div key={index} className='floating-body'>\n              <img alt='profile' src={user.profile_picture} />\n              <div className='floating-body-text'>\n                <p>{user.username}</p>\n                <p>Now playing: {user.song}</p>\n                <audio controls={true} autoPlay name=\"media\">\n                  <source src={user.preview_url} type=\"audio/mpeg\" />\n                </audio>\n              </div>\n            </div>\n          ))}\n        </div>\n      ) : (\n        <p>Loading...</p>\n      )}\n    </div>\n    {userList.map((user, index) => (\n        <FloatingComponent\n          key={index} // Make sure to use a unique key for each component\n          data={{\n            userSong: user.userSong,\n            userImg: user.userImg,\n            userName: user.userName,\n            songPreview: user.songPreview,\n          }}\n          onClick={handleComponentClick}\n        />\n      ))}\n    <Dialog\n      open={open}\n      onClose={handleCloseDialog}\n      PaperProps={{\n        sx:{\n          width:'100vw',\n          height:'60svh',\n          borderRadius:'25%'\n        }\n      }}\n      >\n      <div className='floating-body'>\n        <img alt='profile' src={selectedData? selectedData.userImg : ''}/>\n        <button onClick={handleCloseDialog}>exit</button>\n        <div className='floating-body-text'>\n        <p>{selectedData? selectedData.userName : ''}</p>\n        <p>Now playing: {selectedData? selectedData.userSong : ''}</p>\n        <video controls={true} autoPlay name=\"media\">\n          <source src= {selectedData? selectedData.songPreview : ''}type=\"audio/mpeg\"/>\n          </video>\n          </div>\n      </div>\n    </Dialog>\n  </div>\n  );\n}\n\nexport default Display;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}